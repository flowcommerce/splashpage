{
    "name": "splashpage",

    "imports": [
	{ "uri": "http://www.apidoc.me/flow/common/0.0.1-dev/service.json" }
    ],

    "enums": {
	"publication": {
	    "description": "A publication represents something that a user can subscribe to. An example would be subscribing to notification when we launch the business",
	    "values": [
		{ "name": "launch", "description": "Email me when flow launches" }
	    ]
	}
    },

    "models": {

	"subscription": {
	    "description": "Represents an email address that is currently subscribed to a publication",
	    "fields": [
		{ "name": "guid", "type": "uuid", "description": "Internal unique identifier for this subscription" },
		{ "name": "email", "type": "string", "description": "Case insensitive email address to which to send notifications for this subscription" },
		{ "name": "publication", "type": "publication" },
                { "name": "audit", "type": "io.flow.common.v0.models.audit" }
	    ]
	},

	"subscription_form": {
	    "fields": [
		{ "name": "email", "type": "string" },
		{ "name": "publication", "type": "publication" }
	    ]
	}

    },

    "resources": {
	"io.flow.common.v0.models.healthcheck": {
	    "path": "/_internal_",
            "operations": [
                {
                    "method": "GET",
		    "path": "/healthcheck",
                    "responses": {
                        "200": { "type": "io.flow.common.v0.models.healthcheck" }
                    }
                }
	    ]
	},

	"subscription": {
	    "operations": [
                {
                    "method": "GET",
                    "description": "Search subscriptions. Always paginated.",
                    "parameters": [
                        { "name": "guid", "type": "uuid", "description": "Find the subscription with this guid.", "required": false },
                        { "name": "email", "type": "string", "description": "Find subscriptions for this email. Case insensitive.", "required": false },
                        { "name": "publication", "type": "publication", "description": "Find subscriptions for this publication.", "required": false },
                        { "name": "limit", "type": "long", "default": 25, "description": "The number of records to return", "minimum": 0, "maximum": 100 },
                        { "name": "offset", "type": "long", "default": 0, "description": "Used to paginate. First page of results is 0.", "minimum": 0 }
                    ],
                    "responses": {
                        "200": { "type": "[subscription]" }
                    }
                },

                {
                    "method": "GET",
                    "description": "Returns information about a specific subscription.",
                    "path": "/:guid",
                    "responses": {
                        "200": { "type": "subscription" },
                        "404": { "type": "unit" }
                    }
                },

                {
                    "method": "POST",
                    "description": "Create a new subscription.",
                    "body": { "type": "subscription_form" },
                    "responses": {
                        "201": { "type": "subscription" },
                        "409": { "type": "[io.flow.common.v0.models.error]" }
                    }
                },

                {
                    "method": "DELETE",
		    "path": "/:guid"
                }
            ]
        }
    }

}
